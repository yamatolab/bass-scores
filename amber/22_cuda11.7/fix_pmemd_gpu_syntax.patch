--- src/pmemd/src/cuda/gpu.cpp  2020-04-28 10:19:54.000000000 +0900
+++ src/pmemd/src/cuda/gpuNew.cpp       2023-10-14 02:31:32.943839634 +0900
@@ -2649,7 +2649,7 @@
     }
     // torsions, resttype = 3
     else if (resttype[i] == 3) {
-      if (nmrat[i][0] >= 0 && nmrat[i][1] >= 0 && nmrat[i][2] >= 0 && nmrat[3] >= 0) {
+      if (nmrat[i][0] >= 0 && nmrat[i][1] >= 0 && nmrat[i][2] >= 0 && nmrat[i][3] >= 0) {
         torsions++;
       }
       else {
